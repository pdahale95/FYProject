(iCodeforcesProblem
CodeforcesProblem
p0
(dp1
S'desription'
p2
VD. Gifts by the List\u000atime limit per test1 second\u000amemory limit per test256 megabytes\u000ainputstandard input\u000aoutputstandard output\u000aSasha lives in a big happy family. At the Man's Day all the men of the family gather to celebrate it following their own traditions. There are n men in Sasha's family, so let's number them with integers from 1 to n.\u000aEach man has at most one father but may have arbitrary number of sons.\u000aMan number A is considered to be the ancestor of the man number B if at least one of the following conditions is satisfied:\u000aA\u2009=\u2009B;\u000athe man number A is the father of the man number B;\u000athere is a man number C, such that the man number A is his ancestor and the man number C is the father of the man number B.\u000aOf course, if the man number A is an ancestor of the man number B and A\u2009\u2260\u2009B, then the man number B is not an ancestor of the man number A.\u000aThe tradition of the Sasha's family is to give gifts at the Man's Day. Because giving gifts in a normal way is boring, each year the following happens.\u000aA list of candidates is prepared, containing some (possibly all) of the n men in some order.\u000aEach of the n men decides to give a gift.\u000aIn order to choose a person to give a gift to, man A looks through the list and picks the first man B in the list, such that B is an ancestor of A and gives him a gift. Note that according to definition it may happen that a person gives a gift to himself.\u000aIf there is no ancestor of a person in the list, he becomes sad and leaves the celebration without giving a gift to anyone.\u000aThis year you have decided to help in organizing celebration and asked each of the n men, who do they want to give presents to (this person is chosen only among ancestors). Are you able to make a list of candidates, such that all the wishes will be satisfied if they give gifts according to the process described above?\u000aInput\u000aIn the first line of the input two integers n and m (0\u2009\u2264\u2009m\u2009<\u2009n\u2009\u2264\u2009100\u2009000) are given \u2014 the number of the men in the Sasha's family and the number of family relations in it respectively.\u000aThe next m lines describe family relations: the (i\u2009+\u20091)th line consists of pair of integers pi and qi (1\u2009\u2264\u2009pi,\u2009qi\u2009\u2264\u2009n, pi\u2009\u2260\u2009qi) meaning that the man numbered pi is the father of the man numbered qi. It is guaranteed that every pair of numbers appears at most once, that among every pair of two different men at least one of them is not an ancestor of another and that every man has at most one father.\u000aThe next line contains n integers a1,\u2009a2,\u2009...,\u2009an (1\u2009\u2264\u2009ai\u2009\u2264\u2009n), ith of which means that the man numbered i wants to give a gift to the man numbered ai. It is guaranteed that for every 1\u2009\u2264\u2009i\u2009\u2264\u2009n the man numbered ai is an ancestor of the man numbered i.\u000aOutput\u000aPrint an integer k (1\u2009\u2264\u2009k\u2009\u2264\u2009n) \u2014 the number of the men in the list of candidates, in the first line.\u000aPrint then k pairwise different positive integers not exceeding n \u2014 the numbers of the men in the list in an order satisfying every of the men's wishes, one per line.\u000aIf there are more than one appropriate lists, print any of them. If there is no appropriate list print \u2009-\u20091 in the only line.\u000aExamples\u000ainput\u000a3 2\u000a1 2\u000a2 3\u000a1 2 1\u000aoutput\u000a-1\u000ainput\u000a4 2\u000a1 2\u000a3 4\u000a1 2 3 3\u000aoutput\u000a3\u000a2\u000a1\u000a3\u000aNote\u000aThe first sample explanation:\u000aif there would be no 1 in the list then the first and the third man's wishes would not be satisfied (a1\u2009=\u2009a3\u2009=\u20091);\u000aif there would be no 2 in the list then the second man wish would not be satisfied (a2\u2009=\u20092);\u000aif 1 would stay before 2 in the answer then the second man would have to give his gift to the first man, but he wants to give it to himself (a2\u2009=\u20092).\u000aif, at the other hand, the man numbered 2 would stay before the man numbered 1, then the third man would have to give his gift to the second man, but not to the first (a3\u2009=\u20091).
p3
sS'problemStatement'
p4
VD. Gifts by the List\u000atime limit per test1 second\u000amemory limit per test256 megabytes\u000ainputstandard input\u000aoutputstandard output\u000aSasha lives in a big happy family. At the Man's Day all the men of the family gather to celebrate it following their own traditions. There are n men in Sasha's family, so let's number them with integers from 1 to n.\u000aEach man has at most one father but may have arbitrary number of sons.\u000aMan number A is considered to be the ancestor of the man number B if at least one of the following conditions is satisfied:\u000aA\u2009=\u2009B;\u000athe man number A is the father of the man number B;\u000athere is a man number C, such that the man number A is his ancestor and the man number C is the father of the man number B.\u000aOf course, if the man number A is an ancestor of the man number B and A\u2009\u2260\u2009B, then the man number B is not an ancestor of the man number A.\u000aThe tradition of the Sasha's family is to give gifts at the Man's Day. Because giving gifts in a normal way is boring, each year the following happens.\u000aA list of candidates is prepared, containing some (possibly all) of the n men in some order.\u000aEach of the n men decides to give a gift.\u000aIn order to choose a person to give a gift to, man A looks through the list and picks the first man B in the list, such that B is an ancestor of A and gives him a gift. Note that according to definition it may happen that a person gives a gift to himself.\u000aIf there is no ancestor of a person in the list, he becomes sad and leaves the celebration without giving a gift to anyone.\u000aThis year you have decided to help in organizing celebration and asked each of the n men, who do they want to give presents to (this person is chosen only among ancestors). Are you able to make a list of candidates, such that all the wishes will be satisfied if they give gifts according to the process described above?\u000aInput\u000aIn the first line of the input two integers n and m (0\u2009\u2264\u2009m\u2009<\u2009n\u2009\u2264\u2009100\u2009000) are given \u2014 the number of the men in the Sasha's family and the number of family relations in it respectively.\u000aThe next m lines describe family relations: the (i\u2009+\u20091)th line consists of pair of integers pi and qi (1\u2009\u2264\u2009pi,\u2009qi\u2009\u2264\u2009n, pi\u2009\u2260\u2009qi) meaning that the man numbered pi is the father of the man numbered qi. It is guaranteed that every pair of numbers appears at most once, that among every pair of two different men at least one of them is not an ancestor of another and that every man has at most one father.\u000aThe next line contains n integers a1,\u2009a2,\u2009...,\u2009an (1\u2009\u2264\u2009ai\u2009\u2264\u2009n), ith of which means that the man numbered i wants to give a gift to the man numbered ai. It is guaranteed that for every 1\u2009\u2264\u2009i\u2009\u2264\u2009n the man numbered ai is an ancestor of the man numbered i.\u000aOutput\u000aPrint an integer k (1\u2009\u2264\u2009k\u2009\u2264\u2009n) \u2014 the number of the men in the list of candidates, in the first line.\u000aPrint then k pairwise different positive integers not exceeding n \u2014 the numbers of the men in the list in an order satisfying every of the men's wishes, one per line.\u000aIf there are more than one appropriate lists, print any of them. If there is no appropriate list print \u2009-\u20091 in the only line.\u000aExamples\u000ainput\u000a3 2\u000a1 2\u000a2 3\u000a1 2 1\u000aoutput\u000a-1\u000ainput\u000a4 2\u000a1 2\u000a3 4\u000a1 2 3 3\u000aoutput\u000a3\u000a2\u000a1\u000a3\u000aNote\u000aThe first sample explanation:\u000aif there would be no 1 in the list then the first and the third man's wishes would not be satisfied (a1\u2009=\u2009a3\u2009=\u20091);\u000aif there would be no 2 in the list then the second man wish would not be satisfied (a2\u2009=\u20092);\u000aif 1 would stay before 2 in the answer then the second man would have to give his gift to the first man, but he wants to give it to himself (a2\u2009=\u20092).\u000aif, at the other hand, the man numbered 2 would stay before the man numbered 1, then the third man would have to give his gift to the second man, but not to the first (a3\u2009=\u20091).
p5
sS'name'
p6
VD. Gifts by the List
p7
sS'tags'
p8
Vdfs and similar trees 
p9
sS'url'
p10
Vhttp://codeforces.com/problemset/problem/681/D
p11
sS'memorylimit'
p12
V256 megabytes
p13
sS'timelimit'
p14
V1 second
p15
sS'problemId'
p16
V681/D
p17
sS'id'
p18
c__builtin__
id
p19
sb.